#!/usr/bin/env php
<?php

require __DIR__.'/../vendor/autoload.php';

use AkeneoE3\Infrastructure\Command;
use AkeneoE3\Infrastructure\EtlFactory;
use AkeneoE3\Infrastructure\Profile\ConnectionProfileFactory;
use AkeneoE3\Infrastructure\Request\RuleSetTransformRequestFactory;
use AkeneoE3\Infrastructure\Request\TransformRequestFactory;
use Symfony\Component\Console\Application;

$etlFactory = new EtlFactory();

$transformRequestFactory = new TransformRequestFactory(
    new ConnectionProfileFactory(),
);

$ruleSetTransformRequestFactory = new RuleSetTransformRequestFactory(
    new ConnectionProfileFactory(),
);


$application = new Application('AkeneoE3', '@package_version@');
$application->add(new Command\TransformCommand($etlFactory, $transformRequestFactory));
$application->add(new Command\MigrateCommand($etlFactory, $ruleSetTransformRequestFactory));

$application->run();
